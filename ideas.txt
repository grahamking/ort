##
## Suggestions from Codex 5.1 to further reduce binary size:
## (moved to bottom section as I try them)
##

- Currently target/release/ort is ~240 KiB. The big wins left are linker- and panic/unwind-related. Consider building with nightly using -Zbuild-std=core,alloc -Zbuild-std -features=panic_immediate_abort plus panic="abort" (already set) so you can delete the manual eh_personality shim and the #[link(name="gcc_s")] stub in src/main.rs, removing the libgcc
unwinder dependency altogether.

- Drop stdio entirely: the only use is libc::printf for errors in src/main.rs. Switching to a tiny write(2, "...") path (and keeping messages static) avoids pulling in glibc’s formatted I/O code and locale tables, which is often ~10–20 KiB.

- Trim formatting machinery in errors: src/common/error.rs stores Strings and implements Display, ToString, and context.join, which drags in core::fmt glue and allocation helpers. Converting OrtError to hold &'static str plus a small error code (or a fixed small buffer) and printing fixed strings can shed several KB.

- Feature-gate bulk features for a “tiny” build: disable multi-model concurrency and background threads (drops pthread/stack-mmap code in src/common/thread.rs and the extra prompt threads in src/input/prompt.rs), and optionally drop list/config-file support (removes file/dir scanning and JSON emission). A minimal cargo feature that excludes those modules would strip tens of KB when you only need a single prompt/send path.

- Reduce heap usage in TLS: src/net/tls.rs builds ClientHello/extensions with multiple Vecs and uses format!. Replacing them with fixed-size stack buffers and manual length accounting (no format!, no ToString) both shrinks code and keeps allocator code paths colder; similarly, consider an #[inline(never)] on the larger crypto helpers to avoid LTO inlining bloat.

##
## Things I tried based on GPT 5.1 Codex Max suggestions
##

## These work, figure out if we want them

(in RUSTFLAGS)

Disable inlining. Saves ~12 Kib, but will possibly be slower.
	-C llvm-args=--inline-threshold=0

Don't make it a PIE (Position Independent Executable). Saves 7 KiB.
	-C relocation-model=static

(in Cargo.toml)

Compile for size rather than performance. Save 20 Kib.
	[profile.release]
	opt-level = "z" # instead of "s"


## These don't work, it gets bigger

(in RUSTFLAGS)

"fold identical functions" and remove build id. Make it about 5 KiB bigger, which is strange.
	-C link-args=-Wl,--icf=all,--build-id=none

"drop long path strings from diagnostics metadata"
	--remap-path-prefix=.=.  # This also goes in RUSTFLAGS

## This I had already and need to keep
## in RUSTFLAGS

-C target-cpu=native

## How to do it
##

Set `RUSTFLAGS` in a `.cargo/config.toml` file at the root of your project:

    [env]
    RUSTFLAGS="-C target-cpu=native"

OR (also in .cargo/config.toml)

	[build]
	rustflags = ["-C", "target-cpu=native"]

